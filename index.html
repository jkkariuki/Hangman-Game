<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Hangman</title>
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>

<body>
    <div id="game">
        <p>Let's play NBA hangman. Guess a letter to start . </p>
    </div>
    <div id="wordSpace">
    </div>
    <div id="stats">
    </div>
    <div id="gameOver">
    </div>
    <script type="text/javascript">
    function playGame() {

        var guessesRemaining = 12;
        var lettersGuessed = [];
        var points = 0;
        var wins = 0;
        var losses = 0;
        var correctGuesses = []
        var keyOptions = ["a", "b", "c", "d", "e", "f", "g",
            "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t",
            "u", "v", "w", "x", "y", "z"
        ];

        function playWord() {

            var words = ["jordan", "kobe", "magic", "wade", "lebron", "shaq", "iverson", "mcgrady", "durant", ];
            var computerChoice = words[(Math.floor(Math.random() * (9)))]; //Math.floor(Math.random() * (max - min + 1)) + min
            var currentWordArray = computerChoice.split("");
            console.log(currentWordArray);

            var letterSpace = new Array(currentWordArray.length);
            console.log(letterSpace.length);
            var letterPosition = -1;


            function endGame() {
                document.getElementById('gameOver').innerHTML = "GameOver";
                guessesRemaining = 12;
                lettersGuessed = [];
                points = 0;
                wins = 0;
                losses = 0;
                correctGuesses = []

            }

            function nextRound() {
                setTimeout(clearCurrentWord, 1350);
                guessesRemaining = 12;
                lettersGuessed = [];
                points = 0;

            }

            function clearCurrentWord() {
                for (var i = 0; i < letterSpace.length; i++) {

                    var item = document.getElementById("position" + i);
                    item.parentNode.removeChild(item);
                }
            }

            function blankSpaces() {
                for (var i = 0; i < letterSpace.length; i++) {
                    letterPosition++;
                    letterSpace[i] = "__"
                    var node = document.createElement("span");
                    node.setAttribute("id", "position" + letterPosition)
                    var textnode = document.createTextNode(letterSpace[i]);
                    node.appendChild(textnode);
                    document.getElementById('wordSpace').appendChild(node);
                }
            }

            setTimeout(blankSpaces, 1351);


            document.onkeyup = function(event) {
                var userChoice = event.key.toLowerCase();
                //prevents user from choosing anything besides a letter.
                if (keyOptions.indexOf(userChoice) === -1) {
                    alert("letters only please");
                } else if (correctGuesses.indexOf(userChoice) > -1) {

                    alert("You got that already, genius!!");
                }

                //if user chooses a correct letter that letter appears in the appropriate position. adds a point. 
                else if (currentWordArray.indexOf(userChoice) > -1) {
                    correctGuesses.push(userChoice);
                    console.log(correctGuesses);
                    points++;
                    document.getElementById("position" + currentWordArray.indexOf(userChoice)).innerHTML = event.key;

                    //if user chooses incorrectly the letter is placed in the lettersGuessed array and the loses loses one guess.
                } else if (lettersGuessed.indexOf(userChoice) === -1) {
                    lettersGuessed.push(userChoice);
                    guessesRemaining--;
                }


                //point systsem helped me determine a "win". Each correct letter is worth one point. To win you must earn all possible points in a given word. This also replenishes the users guesses and clears the correct guesses array to make room for the new word. 
                if (points === letterSpace.length) {
                    correctGuesses = [];
                    console.log(correctGuesses);
                    wins++
                    nextRound();
                    playWord();
                }
                //This alerts the user that they have lost the game. User failed to earn all possible points in within alloted # of guesses.
                if (guessesRemaining === 0) {
                    console.log(losses);
                    setTimeout(alert("you lose"), 500);
                    endGame()
                    setTimeout(clearCurrentWord, 200);
                    alert("play again");
                    setTimeout(playGame, 500);
                    document.getElementById("gameOver").innerHTML = "";
                    losses++;
                    playWord();


                }


                //fills the div with id = "stats". 
                var html =
                    "<p>Guesses Remaining: " + guessesRemaining + "</p>" +
                    "<p> Letters Guessed: " + lettersGuessed +
                    "<p>wins: " + wins + "</p>" +
                    "<p>losses: " + losses + "</p>";
                document.getElementById("stats").innerHTML = html;


            }
        }
        playWord();
    }
    playGame();
    </script>
</body>

</html>